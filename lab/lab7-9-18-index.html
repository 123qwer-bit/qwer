<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文学书苑</title>
    <link rel="stylesheet" href="../css/style7-9.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="time-bar" id="timeBar"></div>
    <header class="fixed-header">
        <div class="header-container">
            <div class="logo">
                <i class="fas fa-book-reader"></i>
                <span>文学书苑</span>
            </div>
            <ul class="main-nav">
                <li><a href="#"><i class="fas fa-home"></i>首页</a></li>
                <li class="dropdown">
                    <a href="#"><i class="fas fa-filter"></i>图书分类</a>
                    <ul class="dropdown-menu">
                        <li><a href="#"><i class="fas fa-dollar"></i>9.9元包邮</a></li>
                        <li><a href="#"><i class="fas fa-dollar"></i>10元-20元</a></li>
                        <li><a href="#"><i class="fas fa-dollar"></i>20元-30元</a></li>
                        <li><a href="#"><i class="fas fa-dollar"></i>30元-40元</a></li>
                        <li><a href="#"><i class="fas fa-dollar"></i>40元-50元</a></li>
                        <li><a href="#"><i class="fas fa-dollar"></i>50元以上</a></li>
                    </ul>
                </li>
                <li><a href="#"><i class="fas fa-fire"></i>热门推荐</a></li>
                <li><a href="#" class="modal-trigger" id="loginTrigger"><i class="fas fa-user"></i>登录/注册</a></li>
                <li><a href="#" class="modal-trigger" id="formTrigger"><i class="fas fa-paper-plane"></i>图书订阅</a></li>
            </ul>
            <div class="search-container">
                <input type="text" class="search-input" placeholder="搜索图书名称、作者..." id="searchInput">
                <div class="search-filters">
                    <button class="search-filter-btn active" data-filter="all">全部</button>
                    <button class="search-filter-btn" data-filter="book">图书</button>
                    <button class="search-filter-btn" data-filter="author">作者</button>
                </div>
                <div class="search-results" id="searchResults"></div>
            </div>
        </div>
    </header>
    <div class="cart-fixed">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-count" id="cartCount">0</span>
    </div>
    <a href="#" class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </a>
    <div class="main-container">
        <div id="cartoon">
            <ul class="picture">
                <li>
                    <img src="../image7-9/p1.png" alt="图书展销轮播图1">
                    <div class="carousel-caption">
                        <h2>2025年度畅销图书盛典</h2>
                        <p>精选千余本优质图书，限时折扣低至5折</p>
                        <button class="btn">立即抢购</button>
                    </div>
                </li>
                <li>
                    <img src="../image7-9/p2.png" alt="图书展销轮播图2">
                    <div class="carousel-caption">
                        <h2>全新上架 · 精品电子书</h2>
                        <p>海量电子书库，随时随地畅享阅读乐趣</p>
                        <button class="btn">浏览电子书</button>
                    </div>
                </li>
                <li>
                    <img src="../image7-9/p3.png" alt="图书展销轮播图3">
                    <div class="carousel-caption">
                        <h2>会员专享 · 独家福利</h2>
                        <p>开通会员立享8折优惠，免费领取精选图书</p>
                        <button class="btn">开通会员</button>
                    </div>
                </li>
            </ul>
            <div class="carousel-indicators">
                <div class="indicator active"></div>
                <div class="indicator"></div>
                <div class="indicator"></div>
            </div>
        </div>
        <div class="flash-sale">
            <div class="flash-sale-title">
                <i class="fas fa-clock"></i>
                限时抢购（剩余时间）
            </div>
            <div class="countdown" id="countdown">
                <div class="countdown-item" id="countdownHours">00</div>
                <div class="countdown-label">
                <span>时</span>
                </div>
                <div class="countdown-item" id="countdownMinutes">00</div>
                <div class="countdown-label">
                <span>分</span>
                </div>
                <div class="countdown-item" id="countdownSeconds">00</div>
                <div class="countdown-label">
                <span>秒</span>
                </div>
            </div>
            <div class="flash-sale-books" id="flashSaleBooks">
            </div>
        </div>
        <div class="content-wrapper">
            <aside class="left-sidebar">
                <h3 class="category-title">
                    <i class="fas fa-list"></i>
                    图书分类
                </h3>
                <ul class="category-list">
                    <li><a href="#"><i class="fas fa-book-reader"></i>文学小说</a></li>
                    <li><a href="#"><i class="fas fa-history"></i>历史传记</a></li>
                    <li><a href="#"><i class="fas fa-brain"></i>哲学宗教</a></li>
                    <li><a href="#"><i class="fas fa-users"></i>社会科学</a></li>
                    <li><a href="#"><i class="fas fa-landmark"></i>政治军事</a></li>
                    <li><a href="#"><i class="fas fa-gavel"></i>法律</a></li>
                    <li><a href="#"><i class="fas fa-chart-line"></i>经济管理</a></li>
                    <li><a href="#"><i class="fas fa-coins"></i>金融投资</a></li>
                    <li><a href="#"><i class="fas fa-couch"></i>生活休闲</a></li>
                    <li><a href="#"><i class="fas fa-palette"></i>艺术摄影</a></li>
                    <li><a href="#"><i class="fas fa-flask"></i>科技科普</a></li>
                    <li><a href="#"><i class="fas fa-laptop-code"></i>计算机</a></li>    
                </ul>
            </aside>
            <main class="middle-content">
                <div class="section">
                    <div class="section-title">
                        <span><i class="fas fa-circle"></i>精品图书推荐</span>
                        <a href="#">查看更多 <i class="fas fa-angle-right"></i></a>
                    </div>
                    <div class="circle-books">
                        <div class="circle-container" id="circleContainer">
                        </div>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">
                        <span><i class="fas fa-fire"></i>热门畅销图书</span>
                        <a href="#">查看更多 <i class="fas fa-angle-right"></i></a>
                    </div>
                    <div class="sort-filter-bar">
                        <div class="sort-buttons">
                            <button class="sort-btn active" data-sort="hot"><i class="fas fa-fire"></i> 热度排序</button>
                            <button class="sort-btn" data-sort="price-asc"><i class="fas fa-sort-amount-down"></i> 价格从低到高</button>
                            <button class="sort-btn" data-sort="price-desc"><i class="fas fa-sort-amount-up"></i> 价格从高到低</button>
                            <button class="sort-btn" data-sort="new"><i class="fas fa-clock"></i> 最新上架</button>
                        </div>
                        <div class="filter-options">
                            <input type="checkbox" id="filterDiscount" name="filterDiscount">
                            <label for="filterDiscount">仅看折扣图书</label>
                        </div>
                    </div>

                    <div class="hot-books" id="hotBooks">
                    </div>
                </div>
                <div class="section random-books">
                    <div class="random-header">
                        <h3 class="section-title" style="border: none; margin: 0;">
                            <span><i class="fas fa-random"></i>猜你喜欢</span>
                        </h3>
                        <button class="refresh-btn" id="refreshRandomBooks">
                            <i class="fas fa-sync-alt"></i> 刷新推荐
                        </button>
                    </div>
                    <div class="hot-books" id="randomBooks">
                    </div>
                </div>
                <div class="section new-books">
                    <div class="section-title">
                        <span><i class="fas fa-star"></i>新书上架</span>
                        <a href="#">查看更多 <i class="fas fa-angle-right"></i></a>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>图书封面</th>
                                <th>图书名称</th>
                                <th>作者</th>
                                <th>分类</th>
                                <th>价格</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="newBooksTable">
                        </tbody>
                    </table>
                </div>
            </main>
            <aside class="right-sidebar">
                <div class="promotion">
                <h3 class="promotion-title">秋分特惠</h3>
                <div class="promotion-img">
                    <img src="https://picsum.photos/seed/promo1/400/300" alt="促销图片">
                </div>
                <div class="promotion-info">
                    <p>精选图书</p>
                    <p>限时折扣</p>
                    <div class="promotion-price">5折起</div>
                    <a href="#" class="promotion-btn">立即查看</a>
                </div>
            </div>
            
            <div class="promotion">
                <h3 class="promotion-title">会员专享</h3>
                <div class="promotion-img">
                    <img src="https://picsum.photos/seed/promo2/400/300" alt="促销图片">
                </div>
                <div class="promotion-info">
                    <p>新书抢先读</p>
                    <p>会员8折优惠</p>
                    <div class="promotion-price">8折</div>
                    <a href="#" class="promotion-btn">开通会员</a>
                </div>
            </div>
            
            <div class="promotion">
                <h3 class="promotion-title">满减活动</h3>
                <div class="promotion-img">
                    <img src="https://picsum.photos/seed/promo3/400/300" alt="促销图片">
                </div>
                <div class="promotion-info">
                    <p>满100减30</p>
                    <p>满200减80</p>
                    <div class="promotion-price">限时3天</div>
                    <a href="#" class="promotion-btn">参与活动</a>
                </div>
            </div>
        </div>
            </aside>
        </div>
    </div>
    <footer>
        <div class="footer-container">
            <div class="footer-social">
                <a href="#" class="social-icon"><i class="fab fa-weixin"></i></a>
                <a href="#" class="social-icon"><i class="fab fa-weibo"></i></a>
                <a href="#" class="social-icon"><i class="fab fa-qq"></i></a>
            </div>
            <div class="copyright">
                <p>联系电话：666-666-6666 | 邮箱：nichousha@chounizadi.com</p>
            </div>
        </div>
    </footer>
    <div class="login-modal" id="loginModal">
        <div class="login-container">
            <div class="login-header">
                <h2>用户登录</h2>
                <button class="close-modal" id="closeLoginModal"><i class="fas fa-times"></i></button>
            </div>
            <div class="login-body">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginUsername">用户名/手机号</label>
                        <input type="text" class="form-control" id="loginUsername" placeholder="请输入用户名或手机号" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">登录密码</label>
                        <input type="password" class="form-control" id="loginPassword" placeholder="请输入登录密码" required>
                        <div class="password-strength">
                            <div class="strength-bar" id="strengthBar1"></div>
                            <div class="strength-bar" id="strengthBar2"></div>
                            <div class="strength-bar" id="strengthBar3"></div>
                        </div>
                        <div class="strength-text" id="strengthText">请输入密码</div>
                    </div>
                    <div class="login-options">
                        <div class="remember-me">
                            <input type="checkbox" id="rememberMe" name="rememberMe">
                            <label for="rememberMe">记住我</label>
                        </div>
                        <a href="#" class="forgot-password">忘记密码？</a>
                    </div>
                    <button type="submit" class="login-btn">登录</button>
                </form>
                <div class="register-link">
                    还没有账号？ <a href="#" class="modal-trigger" id="switchToRegister">立即注册</a>
                </div>
                <div class="divider">其他登录方式</div>
                <div class="social-login">
                    <button class="social-btn wechat"><i class="fab fa-weixin"></i></button>
                    <button class="social-btn qq"><i class="fab fa-qq"></i></button>
                    <button class="social-btn weibo"><i class="fab fa-weibo"></i></button>
                </div>
            </div>
        </div>
    </div>
    <div class="book-form-modal" id="bookFormModal">
        <div class="book-form-container">
            <div class="book-form-header">
                <h2>图书推荐订阅</h2>
                <button class="close-modal" id="closeBookFormModal"><i class="fas fa-times"></i></button>
            </div>
            <div class="book-form-body">
                <form id="bookSubscribeForm">
                    <div class="book-form-group">
                        <label for="subscriberName"><i class="fas fa-user"></i>姓名</label>
                        <input type="text" class="book-form-control" id="subscriberName" placeholder="请输入您的姓名" required>
                    </div>
                    <div class="book-form-group">
                        <label for="subscriberPhone"><i class="fas fa-phone"></i>手机号码</label>
                        <input type="tel" class="book-form-control" id="subscriberPhone" placeholder="请输入您的手机号码" required>
                    </div>
                    <div class="book-form-group code-group">
                        <input type="text" class="book-form-control" id="verifyCode" placeholder="请输入验证码" required>
                        <button type="button" class="code-btn" id="sendVerifyCode">获取验证码</button>
                    </div>
                    <fieldset>
                        <legend><i class="fas fa-venus-mars"></i>性别</legend>
                        <div class="gender-options">
                            <label><input type="radio" name="gender" value="male" checked> 男</label>
                            <label><input type="radio" name="gender" value="female"> 女</label>
                            <label><input type="radio" name="gender" value="other"> 其他</label>
                        </div>
                    </fieldset>
                    <fieldset>
                        <legend><i class="fas fa-heart"></i>感兴趣的图书分类</legend>
                        <div class="interest-options">
                            <label><input type="checkbox" name="interest" value="literature"> 文学小说</label>
                            <label><input type="checkbox" name="interest" value="science"> 科普读物</label>
                            <label><input type="checkbox" name="interest" value="social"> 人文社科</label>
                            <label><input type="checkbox" name="interest" value="children"> 儿童绘本</label>
                            <label><input type="checkbox" name="interest" value="computer"> 计算机技术</label>
                        </div>
                    </fieldset>
                    <div class="book-form-group">
                        <label for="subscriberDesc"><i class="fas fa-comment"></i>个人阅读偏好</label>
                        <textarea class="book-form-control" id="subscriberDesc" placeholder="请描述您的阅读偏好，我们将为您精准推荐图书"></textarea>
                    </div>
                    <div class="book-form-group">
                        <label for="avatarUpload"><i class="fas fa-upload"></i>上传头像（可选）</label>
                        <div class="file-upload">
                            <input type="file" id="avatarUpload" accept="image/*">
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="reset" class="form-btn reset-btn">重置</button>
                        <button type="submit" class="form-btn submit-btn">提交订阅</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script>
        const bookData = [
            { id: 1, title: "《百年孤独》", author: "加西亚·马尔克斯", category: "文学小说", price: 59.8, discountPrice: 39.9, cover: "../image7-9/w1.webp", rating: 4.9, desc: "魔幻现实主义的巅峰之作，讲述布恩迪亚家族七代人的兴衰沉浮，描绘了一个小镇的百年沧桑。" },
            { id: 2, title: "《人类简史》", author: "尤瓦尔·赫拉利", category: "科普读物", price: 68.0, discountPrice: 45.0, cover: "../image7-9/w2.webp", rating: 4.8, desc: "从认知革命、农业革命到科学革命，讲述人类如何从普通动物进化为地球主宰的宏大历史。" },
            { id: 3, title: "《中国通史》", author: "吕思勉", category: "人文社科", price: 98.0, discountPrice: 69.0, cover: "../image7-9/j1.jpg", rating: 4.7, desc: "一部系统完整的中国通史著作，涵盖从上古时期到近代的中国历史变迁与文化发展。" },
            { id: 4, title: "《猜猜我有多爱你》", author: "山姆·麦克布雷尼", category: "儿童绘本", price: 32.8, discountPrice: 22.0, cover: "../image7-9/j2.jpg", rating: 4.9, desc: "经典儿童绘本，通过小兔子与大兔子的对话，传递出浓浓的亲子之爱，适合3-6岁儿童阅读。" },
            { id: 5, title: "《JavaScript高级程序设计》", author: "尼古拉斯·泽卡斯", category: "计算机技术", price: 128.0, discountPrice: 89.0, cover: "../image7-9/j3.jpg", rating: 4.9, desc: "JavaScript领域的经典教材，全面讲解JavaScript的核心概念、高级特性与实战技巧。" },
            { id: 6, title: "《黄帝内经》", author: "佚名", category: "医学健康", price: 78.0, discountPrice: 55.0, cover: "../image7-9/j4.jpg", rating: 4.6, desc: "中国传统医学的经典著作，阐述了中医的基本理论、养生之道与诊疗方法，流传千年。" },
            { id: 7, title: "《穷查理宝典》", author: "彼得·考夫曼", category: "经管励志", price: 108.0, discountPrice: 75.0, cover: "../image7-9/j5.jpg", rating: 4.9, desc: "收录查理·芒格的智慧箴言与思维模型，分享其投资理念与人生哲学，极具启发意义。" },
            { id: 8, title: "《美的历程》", author: "李泽厚", category: "艺术设计", price: 58.0, discountPrice: 39.0, cover: "../image7-9/j6.jpg", rating: 4.8, desc: "梳理中国从远古到明清的艺术发展脉络，探讨中国美学的演变与精神内涵，文笔优美。" },
            { id: 9, title: "《三体》三部曲", author: "刘慈欣", category: "科幻小说", price: 99.0, discountPrice: 69.0, cover: "../image7-9/w3.webp", rating: 4.9, desc: "中国科幻文学的里程碑之作，讲述地球人类文明与三体文明的交锋，展现宏大的宇宙图景。" },
            { id: 10, title: "《高效能人士的七个习惯》", author: "史蒂芬·柯维", category: "经管励志", price: 68.0, discountPrice: 45.0, cover: "../image7-9/j7.jpg", rating: 4.7, desc: "风靡全球的个人成长经典，提出积极主动、以终为始等七个习惯，帮助人们实现自我提升。" },
            { id: 11, title: "《小王子》", author: "安托万·德·圣-埃克苏佩里", category: "儿童绘本", price: 29.8, discountPrice: 19.9, cover: "../image7-9/j8.jpg", rating: 4.9, desc: "一部写给成年人的童话，通过小王子的星际旅行，探讨爱与责任的真谛，治愈无数心灵。" },
            { id: 12, title: "《Python编程：从入门到实践》", author: "埃里克·马瑟斯", category: "计算机技术", price: 89.0, discountPrice: 62.0, cover: "../image7-9/j9.jpg", rating: 4.8, desc: "零基础Python入门教材，通过实战项目帮助读者快速掌握Python编程技能，适合初学者。" }
        ];
        function updateTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            const weekDays = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];
            const weekDay = weekDays[now.getDay()];
            document.getElementById('timeBar').textContent = `${year}年${month}月${day}日 ${hours}:${minutes}:${seconds} ${weekDay}`;
        }
        setInterval(updateTime, 1000);
        updateTime(); 
        function initCountdown() {
            const endTime = new Date();
            endTime.setHours(endTime.getHours() + 2);
            endTime.setMinutes(endTime.getMinutes() + 0);
            endTime.setSeconds(endTime.getSeconds() + 0);
            function updateCountdown() {
                const now = new Date();
                const diff = endTime - now;
                if (diff <= 0) {
                    document.getElementById('countdownHours').textContent = '00';
                    document.getElementById('countdownMinutes').textContent = '00';
                    document.getElementById('countdownSeconds').textContent = '00';
                    clearInterval(countdownTimer);
                    return;
                }
                const hours = Math.floor(diff / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                document.getElementById('countdownHours').textContent = String(hours).padStart(2, '0');
                document.getElementById('countdownMinutes').textContent = String(minutes).padStart(2, '0');
                document.getElementById('countdownSeconds').textContent = String(seconds).padStart(2, '0');
            }
            const countdownTimer = setInterval(updateCountdown, 1000);
            updateCountdown();
        }
        initCountdown();
        function renderFlashSaleBooks() {
            const flashSaleContainer = document.getElementById('flashSaleBooks');
            const flashBooks = bookData.slice(0, 6); 
            flashSaleContainer.innerHTML = '';
            flashBooks.forEach(book => {
                const bookItem = document.createElement('div');
                bookItem.className = 'flash-book-item';
                bookItem.innerHTML = `
                    <div class="flash-book-img">
                        <img src="${book.cover}" alt="${book.title}">
                    </div>
                    <div class="flash-book-info">
                        <div class="flash-book-title">${book.title}</div>
                        <div class="flash-book-price">
                            <span class="original-price">¥${book.price}</span>
                            <span class="sale-price">¥${book.discountPrice}</span>
                        </div>
                    </div>
                `;
                flashSaleContainer.appendChild(bookItem);
            });
        }
        renderFlashSaleBooks();
        function renderCircleBooks() {
            const circleContainer = document.getElementById('circleContainer');
            const circleBooks = bookData.slice(0, 8); 
            const angleStep = 360 / circleBooks.length;
            const radius = 250; 
            circleContainer.innerHTML = '';
            circleBooks.forEach((book, index) => {
                const angle = index * angleStep;
                const radian = (angle * Math.PI) / 180;
                const x = Math.sin(radian) * radius;
                const z = Math.cos(radian) * radius;
                const bookItem = document.createElement('div');
                bookItem.className = 'circle-book-item';
                bookItem.style.transform = `rotateY(${angle}deg) translateZ(${radius}px)`;
                bookItem.innerHTML = `
                    <div class="book-card">
                        <div class="book-front">
                            <img src="${book.cover}" alt="${book.title}">
                            <div class="book-title">${book.title}</div>
                        </div>
                        <div class="book-back">
                            <h4>${book.title}</h4>
                            <div class="book-meta"><span>作者：</span>${book.author}</div>
                            <div class="book-meta"><span>分类：</span>${book.category}</div>
                            <div class="book-meta"><span>价格：</span>¥${book.price}（折扣¥${book.discountPrice}）</div>
                            <div class="book-rating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                ${book.rating >= 4.5 ? '<i class="fas fa-star"></i>' : '<i class="fas fa-star-half-alt"></i>'}
                                ${book.rating}
                            </div>
                            <div class="book-desc">${book.desc}</div>
                            <button class="add-to-cart" data-id="${book.id}">
                                <i class="fas fa-shopping-cart"></i> 加入购物车
                            </button>
                        </div>
                    </div>
                `;
                circleContainer.appendChild(bookItem);
            });
        }
        renderCircleBooks();
        function renderHotBooks(books = bookData) {
            const hotBooksContainer = document.getElementById('hotBooks');
            hotBooksContainer.innerHTML = '';

            books.forEach(book => {
                const bookItem = document.createElement('div');
                bookItem.className = 'book-item';
                bookItem.innerHTML = `
                    <div class="book-img">
                        <img src="${book.cover}" alt="${book.title}">
                        <div class="book-overlay">
                            <div class="book-detail">
                                <h4>${book.title}</h4>
                                <p>作者：${book.author}</p>
                                <p>分类：${book.category}</p>
                                <p>评分：${book.rating}</p>
                                <button class="add-to-cart" data-id="${book.id}">
                                    <i class="fas fa-shopping-cart"></i> 加入购物车
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="book-title">${book.title}</div>
                    <div class="flash-book-price">
                        <span class="original-price">¥${book.price}</span>
                        <span class="sale-price">¥${book.discountPrice}</span>
                    </div>
                `;
                hotBooksContainer.appendChild(bookItem);
            });

            bindAddToCartEvents(); 
        }
        renderHotBooks();
        function renderRandomBooks() {
            const randomBooksContainer = document.getElementById('randomBooks');
            const randomBooks = [...bookData].sort(() => Math.random() - 0.5).slice(0, 4);
            randomBooksContainer.innerHTML = '';

            randomBooks.forEach(book => {
                const bookItem = document.createElement('div');
                bookItem.className = 'book-item';
                bookItem.innerHTML = `
                    <div class="book-img">
                        <img src="${book.cover}" alt="${book.title}">
                        <div class="book-overlay">
                            <div class="book-detail">
                                <h4>${book.title}</h4>
                                <p>作者：${book.author}</p>
                                <p>分类：${book.category}</p>
                                <p>评分：${book.rating}</p>
                                <button class="add-to-cart" data-id="${book.id}">
                                    <i class="fas fa-shopping-cart"></i> 加入购物车
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="book-title">${book.title}</div>
                    <div class="flash-book-price">
                        <span class="original-price">¥${book.price}</span>
                        <span class="sale-price">¥${book.discountPrice}</span>
                    </div>
                `;
                randomBooksContainer.appendChild(bookItem);
            });

            bindAddToCartEvents(); 
        }
        renderRandomBooks();
        document.getElementById('refreshRandomBooks').addEventListener('click', renderRandomBooks);
        function renderNewBooksTable() {
            const newBooksTable = document.getElementById('newBooksTable');
            const newBooks = bookData.slice(-6); 
            newBooksTable.innerHTML = '';

            newBooks.forEach(book => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><img src="${book.cover}" alt="${book.title}" style="width: 60px; height: 80px; object-fit: cover; border-radius: 4px;"></td>
                    <td>${book.title}</td>
                    <td>${book.author}</td>
                    <td>${book.category}</td>
                    <td>¥${book.price}（折扣¥${book.discountPrice}）</td>
                    <td><button class="add-to-cart" data-id="${book.id}" style="padding: 5px 10px; font-size: 12px;">加入购物车</button></td>
                `;
                newBooksTable.appendChild(tr);
            });

            bindAddToCartEvents();
        }
        renderNewBooksTable();
        const sortButtons = document.querySelectorAll('.sort-btn');
        sortButtons.forEach(btn => {
            btn.addEventListener('click', function() {
                sortButtons.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                const sortType = this.dataset.sort;
                let sortedBooks = [...bookData];

                switch (sortType) {
                    case 'hot':
                        sortedBooks.sort((a, b) => b.rating - a.rating);
                        break;
                    case 'price-asc':
                        sortedBooks.sort((a, b) => a.discountPrice - b.discountPrice);
                        break;
                    case 'price-desc':
                        sortedBooks.sort((a, b) => b.discountPrice - a.discountPrice);
                        break;
                    case 'new':
                        sortedBooks.sort((a, b) => b.id - a.id);
                        break;
                }
                const filterDiscount = document.getElementById('filterDiscount').checked;
                if (filterDiscount) {
                    sortedBooks = sortedBooks.filter(book => book.discountPrice < book.price);
                }

                renderHotBooks(sortedBooks);
            });
        });
        document.getElementById('filterDiscount').addEventListener('change', function() {
            const activeSortBtn = document.querySelector('.sort-btn.active');
            if (activeSortBtn) {
                activeSortBtn.click();
            }
        });
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');
        const searchFilterBtns = document.querySelectorAll('.search-filter-btn');
        let currentFilter = 'all';
        searchFilterBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                searchFilterBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentFilter = this.dataset.filter;
                handleSearch(searchInput.value);
            });
        });
        function handleSearch(keyword) {
            if (!keyword.trim()) {
                searchResults.classList.remove('active');
                return;
            }

            let filteredBooks = [];
            const lowerKeyword = keyword.toLowerCase().trim();

            switch (currentFilter) {
                case 'all':
                    filteredBooks = bookData.filter(book => 
                        book.title.toLowerCase().includes(lowerKeyword) || 
                        book.author.toLowerCase().includes(lowerKeyword) ||
                        book.category.toLowerCase().includes(lowerKeyword)
                    );
                    break;
                case 'book':
                    filteredBooks = bookData.filter(book => 
                        book.title.toLowerCase().includes(lowerKeyword)
                    );
                    break;
                case 'author':
                    filteredBooks = bookData.filter(book => 
                        book.author.toLowerCase().includes(lowerKeyword)
                    );
                    break;
            }
            searchResults.innerHTML = '';
            if (filteredBooks.length > 0) {
                filteredBooks.forEach(book => {
                    const resultItem = document.createElement('div');
                    resultItem.className = 'search-result-item';
                    resultItem.innerHTML = `
                        <div>${book.title}</div>
                        <div class="book-author">作者：${book.author} | 分类：${book.category}</div>
                    `;
                    resultItem.addEventListener('click', function() {
                        searchInput.value = book.title;
                        searchResults.classList.remove('active');
                    });
                    searchResults.appendChild(resultItem);
                });
                searchResults.classList.add('active');
            } else {
                searchResults.innerHTML = '<div class="search-result-item">暂无匹配结果</div>';
                searchResults.classList.add('active');
            }
        }
        searchInput.addEventListener('input', function() {
            handleSearch(this.value);
        });
        document.addEventListener('click', function(e) {
            if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                searchResults.classList.remove('active');
            }
        });
        const loginPassword = document.getElementById('loginPassword');
        const strengthBar1 = document.getElementById('strengthBar1');
        const strengthBar2 = document.getElementById('strengthBar2');
        const strengthBar3 = document.getElementById('strengthBar3');
        const strengthText = document.getElementById('strengthText');
        function checkPasswordStrength(password) {
            let strength = 0;
            if (password.length >= 6) strength++;
            if (password.length >= 10) strength++;
            if (/[a-zA-Z]/.test(password) && /[0-9]/.test(password)) strength++;
            if (/[^a-zA-Z0-9]/.test(password)) strength++;
            strengthBar1.className = 'strength-bar';
            strengthBar2.className = 'strength-bar';
            strengthBar3.className = 'strength-bar';
            strengthText.textContent = '请输入密码';

            switch (strength) {
                case 0:
                case 1:
                    strengthBar1.className = 'strength-bar weak';
                    strengthText.textContent = '密码强度：弱';
                    strengthText.style.color = '#ff4d4f';
                    break;
                case 2:
                case 3:
                    strengthBar1.className = 'strength-bar medium';
                    strengthBar2.className = 'strength-bar medium';
                    strengthText.textContent = '密码强度：中';
                    strengthText.style.color = '#faad14';
                    break;
                case 4:
                    strengthBar1.className = 'strength-bar strong';
                    strengthBar2.className = 'strength-bar strong';
                    strengthBar3.className = 'strength-bar strong';
                    strengthText.textContent = '密码强度：强';
                    strengthText.style.color = '#52c41a';
                    break;
            }
        }
        loginPassword.addEventListener('input', function() {
            checkPasswordStrength(this.value);
        });
        const loginModal = document.getElementById('loginModal');
        const loginTrigger = document.getElementById('loginTrigger');
        const closeLoginModal = document.getElementById('closeLoginModal');

        loginTrigger.addEventListener('click', function(e) {
            e.preventDefault();
            loginModal.classList.add('active');
        });

        closeLoginModal.addEventListener('click', function() {
            loginModal.classList.remove('active');
        });
        loginModal.addEventListener('click', function(e) {
            if (e.target === loginModal) {
                loginModal.classList.remove('active');
            }
        });
        const bookFormModal = document.getElementById('bookFormModal');
        const formTrigger = document.getElementById('formTrigger');
        const closeBookFormModal = document.getElementById('closeBookFormModal');

        formTrigger.addEventListener('click', function(e) {
            e.preventDefault();
            bookFormModal.classList.add('active');
        });

        closeBookFormModal.addEventListener('click', function() {
            bookFormModal.classList.remove('active');
        });
        bookFormModal.addEventListener('click', function(e) {
            if (e.target === bookFormModal) {
                bookFormModal.classList.remove('active');
            }
        });
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            if (username && password) {
                alert('登录成功！');
                loginModal.classList.remove('active');
                this.reset();
            } else {
                alert('请填写完整的登录信息！');
            }
        });
        document.getElementById('bookSubscribeForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('subscriberName').value;
            const phone = document.getElementById('subscriberPhone').value;

            if (name && phone) {
                alert('订阅提交成功！我们将尽快为您推荐优质图书。');
                bookFormModal.classList.remove('active');
                this.reset();
            } else {
                alert('请填写姓名和手机号码！');
            }
        });
        const sendVerifyCodeBtn = document.getElementById('sendVerifyCode');
        let codeTimer = null;
        sendVerifyCodeBtn.addEventListener('click', function() {
            const phone = document.getElementById('subscriberPhone').value;
            if (!/^1[3-9]\d{9}$/.test(phone)) {
                alert('请输入有效的手机号码！');
                return;
            }
            let count = 60;
            this.disabled = true;
            this.textContent = `重新发送(${count}s)`;

            codeTimer = setInterval(() => {
                count--;
                this.textContent = `重新发送(${count}s)`;
                if (count <= 0) {
                    clearInterval(codeTimer);
                    this.disabled = false;
                    this.textContent = '获取验证码';
                }
            }, 1000);

            alert('验证码已发送！');
        });
        let cartCount = 0;
        const cartCountElement = document.getElementById('cartCount');

        function bindAddToCartEvents() {
            const addToCartBtns = document.querySelectorAll('.add-to-cart');
            addToCartBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    cartCount++;
                    cartCountElement.textContent = cartCount;
                    cartCountElement.style.animation = 'none';
                    setTimeout(() => {
                        cartCountElement.style.animation = 'bounce 2s infinite';
                    }, 10);
                    alert('图书已加入购物车！');
                });
            });
        }
        bindAddToCartEvents();
        const backToTopBtn = document.getElementById('backToTop');
        window.addEventListener('scroll', function() {
            if (window.scrollY > 300) {
                backToTopBtn.classList.add('visible');
            } else {
                backToTopBtn.classList.remove('visible');
            }
        });

        backToTopBtn.addEventListener('click', function(e) {
            e.preventDefault();
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        const indicators = document.querySelectorAll('.indicator');
        const picture = document.querySelector('.picture');
        let currentSlide = 0;

        indicators.forEach((indicator, index) => {
            indicator.addEventListener('click', function() {
                currentSlide = index;
                updateIndicators();
                picture.style.animation = 'none';
                picture.style.transform = `translateX(-${currentSlide * 33.333}%)`;
                setTimeout(() => {
                    picture.style.animation = 'slide 15s ease-in-out infinite';
                }, 500);
            });
        });
        function updateIndicators() {
            indicators.forEach((indicator, index) => {
                if (index === currentSlide) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });
        }
        setInterval(() => {
            currentSlide = (currentSlide + 1) % 3;
            updateIndicators();
        }, 5000);
    </script>
</body>
</html>